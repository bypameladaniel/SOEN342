@startuml
participant "<u>:Console" as console
participant "<u>:ConnectionDB" as connectionDB
collections "<u>:Connection" as connection
participant "<u>:TripUtils" as tripUtils
participant "sq.departureCity:<u>City" as departureCity
participant "sq.arrivalCity:<u>City" as arrivalCity

[->console : searchTrips(SearchQuerry sq)
console->connectionDB   : getConnection(sq)

loop [[i = 0..nbOfConnectionList]]
connectionDB->connection : get()
connection-->connectionDB : Connection
end loop

connectionDB-->console : List<Trip> results

opt [If results is empty & departure and arrival city is set in search]
console->tripUtils : findIndirectTrips(sq.getDepartureCity(), sq.getArrivalCity())
tripUtils->departureCity : getOutgoingConnections()
departureCity-->tripUtils: List<Connection> outgoing

tripUtils->arrivalCity : getIncomingConnections()
arrivalCity-->tripUtils: List<Connection> incomming

tripUtils-->console: List<Trip> indirectTrips

console->tripUtils: getSpecificTrip(sq, indirectTrips)

tripUtils-->console: List<Trip> results


end opt

console-->[:results

@enduml